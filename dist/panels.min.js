/**
 * panels.js - version 1.7.1
 *
 * https://github.com/bcorreia/panels.js.git
 * Bruno Correia - mail@bcorreia.com
 *
 */
var Panels=function(){"use strict";function a(){return this.classList.add("on")}function b(a){return this.querySelector('[data-position="'+a+'"]').classList.remove("on")}function c(){for(var a=this.querySelectorAll(".item.on"),b=0;b<a.length;b++)a[b].classList.remove("on")}function d(){var a=this.getBoundingClientRect().top,b=this.nextElementSibling;return b.classList.contains("item")&&b.getBoundingClientRect().top===a?d.call(b):this}function e(a){var b={},c=function(a){for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&("[object Object]"===Object.prototype.toString.call(a[c])?b[c]=e(b[c],a[c]):b[c]=a[c])};c(arguments[0]);for(var d=1;d<arguments.length;d++){var f=arguments[d];c(f)}return b}function f(a,b){void 0!==a&&h(document.body,"scroll",{duration:b.speed,easing:b.easing,offset:a.getBoundingClientRect().top+window.scrollY-b.offset})}function g(a,b){var c=e(j,b||{}),d=Object.create(k,{settings:{value:c},stage:{value:a},stack:{value:[],writable:!0}});d.init(),this.open=function(a,b){k.open.call(d,a,b)},this.close=function(a,b){k.close.call(d,a,b)}}var h=window.Velocity||$.fn.velocity,i=window.imagesLoaded||function(a,b){return b()},j={handlebars:!0,context:{},url:void 0,stage:{fade:!0,speed:800},panel:{classes:"",position:"top",stackable:!0,speed:600,easing:"easeOutQuad"},scroll:{offset:0,speed:600,easing:"easeOutQuad"},onInit:function(){},onBefore:function(){},onAfter:function(){}},k={init:function(){var a,b=this.settings,c=this.stage,d=new Event("init");if(document.addEventListener("init",function(){b.onInit()}),b.handlebars)var e=Handlebars.compile(document.querySelector('[data-role="stage"]').innerHTML),f=e(b.context);b.stage.fade?(f&&c.insertAdjacentHTML("afterbegin",f),c.style.opacity=0,i(c,function(){document.dispatchEvent(d),h(c,{opacity:1},b.stage.speed,function(){c.removeAttribute("style")})})):(f&&c.insertAdjacentHTML("afterbegin",f),document.dispatchEvent(d)),a=c.querySelectorAll(".item");for(var g=0;g<a.length;g++)a[g].setAttribute("data-position",g),a[g].addEventListener("click",function(a){a.preventDefault(),a.target.classList.contains("on")||this.open(a.target)}.bind(this),!1);window.addEventListener("resize",function(){return"between rows"===b.panel.position&&!navigator.userAgent.match(/Mobi/)&&this.reset()}.bind(this),!0)},prepare:function(a,b){var c,d=this.settings,e=document.createElement("div"),f=a.getAttribute("data-position");if(e.className="panel "+d.panel.classes,e.setAttribute("data-paired",f),d.handlebars)return c=Handlebars.compile(document.querySelector('[data-role="panel"]').innerHTML),e.innerHTML=c(d.context.items[f]),this.insert(e,a,b);var g,h=new XMLHttpRequest,i=a.getAttribute("data-query"),j="n="+f;if(i){var k=JSON.parse(i),l=[];for(var m in k)l.push(m+"="+k[m]);g=l.join("&")}g=g&&g.length?g+"&"+j:j,h.open("get",d.url+"?"+g,!0),h.send(),h.onload=function(){return e.innerHTML=h.response,this.insert(e,a,b)}.bind(this)},insert:function(a,b,c){var e,f,g=this.settings,h=this.stage,j=this.stack,k="opacity:0; height:0";switch(a.innerHTML='<div class="-inner">'+a.innerHTML+"</div>",g.panel.position){case"between rows":a.style.cssText=k,f=d.call(b),e=f.parentNode.insertBefore(a,f.nextSibling);break;case"top":a.style.cssText=k,e=h.insertBefore(a,h.firstChild);break;default:e=document.body.insertBefore(a,g.panel.position)}return j.push(e),this.addlisteners(e),("top"===g.panel.position||"between rows"===g.panel.position)&&this.seek(e),i(e,function(){return c.call(e)}.bind(e)),e},addlisteners:function(a){var b=a,c=this.stage,d=this.stack,e=b.querySelectorAll("[data-role]");if(null!==e)for(var f=0;f<e.length;f++)e[f].addEventListener("click",function(a){var e=a.target.getAttribute("data-role");a.preventDefault();for(var a=new Event("click"),f=d[d.length-1].getAttribute("data-paired"),g=c.querySelector('[data-position="'+f+'"]'),h=g.previousElementSibling,i=g.nextElementSibling;null!==i&&i.classList.contains("panel");)i=i.nextElementSibling;switch(e){case"close":this.close(b);break;case"previous":h.dispatchEvent(a);break;case"next":i.dispatchEvent(a)}}.bind(this))},route:function(a){var b=this.settings,c=(this.stage,this.stack);if(!c.length||b.panel.stackable&&"top"===b.panel.position)return a();if(c.length)var d=c[c.length-1];this.close(d,function(){return a()})},seek:function(a){for(var b=a.getAttribute("data-paired"),c=this.stage.querySelector('[data-position="'+b+'"]').previousElementSibling,d=this.stage.querySelector('[data-position="'+b+'"]').nextElementSibling;null!==d&&!d.classList.contains("item");)d=d.nextElementSibling;if(null===d||d.classList.contains("on")){var e=a.querySelector('[data-role="next"]');e&&e.classList.add("disabled")}if(null===c||c.classList.contains("on")||!c.classList.contains("item")){var e=a.querySelector('[data-role="previous"]');e&&e.classList.add("disabled")}},open:function(b,c){var d=this.settings;this.stage;a.call(b),this.route(function(){var a=this.prepare(b,function(){var a={opacity:1};("top"===d.panel.position||"between rows"===d.panel.position)&&(a.height=this.querySelector(".-inner").offsetHeight),"top"===d.panel.position&&f(this,d.scroll),h(this,a,d.panel.speed,d.panel.easing,function(){return this.style.height="auto","between rows"===d.panel.position&&f(b,d.scroll),d.onAfter("open",this),c&&c()}.bind(this))});d.onBefore("open",a)}.bind(this))},close:function(a,c){var d=this.settings,e=this.stage,f=this.stack,g={opacity:0,height:0};void 0!==a&&(h(a,g,d.panel.speed,d.panel.easing,function(){return b.call(e,a.getAttribute("data-paired")),a.parentNode&&a.parentNode.removeChild(a),f.pop(),d.onAfter("close",a),c&&c()}),d.onBefore("close",a))},reset:function(){var a=this.stage,b=this.stack;b.length&&(b.forEach(function(a){a.parentNode.removeChild(a)}),this.stack=[],c.call(a))}};return g}();