/**
 * panels.js - version 1.8.0
 *
 * https://github.com/bcorreia/panels.js.git
 * Bruno Correia - mail@bcorreia.com
 *
 */
var Panels=function(){"use strict";function a(){return this.classList.add("on")}function b(a){return this.querySelector('[data-position="'+a+'"]').classList.remove("on")}function c(){for(var a=this.querySelectorAll(".item.on"),b=0;b<a.length;b++)a[b].classList.remove("on")}function d(){var a=this.getBoundingClientRect().top,b=this.nextElementSibling;return b.classList.contains("item")&&b.getBoundingClientRect().top===a?d.call(b):this}function e(a){var b={},c=function(a){for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&("[object Object]"===Object.prototype.toString.call(a[c])?b[c]=e(b[c],a[c]):b[c]=a[c])};c(arguments[0]);for(var d=1;d<arguments.length;d++){var f=arguments[d];c(f)}return b}function f(a,b){void 0!==a&&h(document.body,"scroll",{duration:b.speed,easing:b.easing,offset:a.getBoundingClientRect().top+window.scrollY-b.offset})}function g(a,b){var c=e(k,b||{}),d=Object.create(l,{settings:{value:c},stage:{value:a},stack:{value:[],writable:!0}});d.init(),this.open=function(a,b){l.open.call(d,a,b)},this.close=function(a,b){l.close.call(d,a,b)}}var h=window.Velocity||$.fn.velocity,i=window.imagesLoaded||function(a,b){return b()},j=window.Handlebars||!1,k={context:{},stage:{fade:!0,speed:800},panel:{position:"top",classes:"",speed:600,easing:"easeOutQuad"},scroll:{offset:0,speed:600,easing:"easeOutQuad"},onInit:function(){},onBefore:function(){},onAfter:function(){}},l={init:function(){var a,b=this.settings,c=this.stage;if(j)var d=j.compile(document.querySelector('[data-role="stage"]').innerHTML),e=d(b.context);b.stage.fade?(e&&c.insertAdjacentHTML("afterbegin",e),c.style.opacity=0,i(c,function(){b.onInit(),h(c,{opacity:1},b.stage.speed,function(){c.removeAttribute("style")})})):(e&&c.insertAdjacentHTML("afterbegin",e),b.onInit()),a=c.querySelectorAll(".item");for(var f=0;f<a.length;f++)a[f].setAttribute("data-position",f),a[f].addEventListener("click",function(a){a.preventDefault(),a.target.classList.contains("on")||this.open(a.target)}.bind(this),!1);window.addEventListener("resize",function(){return"between rows"===b.panel.position&&!navigator.userAgent.match(/Mobi/)&&this.reset()}.bind(this),!0)},prepare:function(a,b){var c,d=this.settings,e=document.createElement("div"),f=a.getAttribute("data-position");if(e.className="panel "+d.panel.classes,e.setAttribute("data-paired",f),j)return c=j.compile(document.querySelector('[data-role="panel"]').innerHTML),e.innerHTML=c(d.context.items[f]),this.insert(e,a,b);var g,h=new XMLHttpRequest,i=a.getAttribute("data-query"),k="n="+f;if(i){var l=JSON.parse(i),m=[];for(var n in l)m.push(n+"="+l[n]);g=m.join("&")}g=g&&g.length?g+"&"+k:k,h.open("get",d.context+"?"+g,!0),h.send(),h.onload=function(){return e.innerHTML=h.response,this.insert(e,a,b)}.bind(this)},insert:function(a,b,c){var e,f,g,h=this.settings,j=this.stage,k=this.stack,l="opacity:0; height:0";switch(a.innerHTML='<div class="-inner">'+a.innerHTML+"</div>",h.panel.position){case"between rows":a.style.cssText=l,f=d.call(b),e=f.parentNode.insertBefore(a,f.nextSibling);break;case"top":a.style.cssText=l,e=j.insertBefore(a,j.firstChild);break;default:e=document.body.insertBefore(a,h.panel.position)}if(k.push(e),g=a.querySelectorAll("[data-role]"))for(var m=0;m<g.length;m++)g[m].addEventListener("click",function(b){b.preventDefault();for(var c=new Event("click"),d=k[k.length-1].getAttribute("data-paired"),e=j.querySelector('[data-position="'+d+'"]'),f=e.previousElementSibling,g=e.nextElementSibling;null!==g&&g.classList.contains("panel");)g=g.nextElementSibling;switch(b.target.getAttribute("data-role")){case"close":this.close(a);break;case"previous":f.dispatchEvent(c);break;case"next":g.dispatchEvent(c)}}.bind(this));return("top"===h.panel.position||"between rows"===h.panel.position)&&this.seek(e),i(e,function(){return c.call(e)}.bind(e)),e},seek:function(a){for(var b=a.getAttribute("data-paired"),c=this.stage.querySelector('[data-position="'+b+'"]').previousElementSibling,d=this.stage.querySelector('[data-position="'+b+'"]').nextElementSibling;null!==d&&!d.classList.contains("item");)d=d.nextElementSibling;if(null===d||d.classList.contains("on")){var e=a.querySelector('[data-role="next"]');e&&e.classList.add("disabled")}if(null===c||c.classList.contains("on")||!c.classList.contains("item")){var e=a.querySelector('[data-role="previous"]');e&&e.classList.add("disabled")}},open:function(b,c){var d=this.settings,e=this.stack;a.call(b);var g=function(){var a=this.prepare(b,function(){var a={opacity:1};("top"===d.panel.position||"between rows"===d.panel.position)&&(a.height=this.querySelector(".-inner").offsetHeight),"top"===d.panel.position&&f(this,d.scroll),h(this,a,d.panel.speed,d.panel.easing,function(){return this.style.height="auto","between rows"===d.panel.position&&f(b,d.scroll),d.onAfter("open",this),c&&c()}.bind(this))});d.onBefore("open",a)}.bind(this);return e.length&&"top"!==d.panel.position?void this.close(e[e.length-1],function(){g()}):g()},close:function(a,c){var d=this.settings,e=this.stage,f=this.stack;void 0!==a&&(h(a,{opacity:0,height:0},d.panel.speed,d.panel.easing,function(){return b.call(e,a.getAttribute("data-paired")),a.parentNode&&a.parentNode.removeChild(a),f.pop(),d.onAfter("close",a),c&&c()}),d.onBefore("close",a))},reset:function(){var a=this.stage,b=this.stack;b.length&&(b.forEach(function(a){a.parentNode.removeChild(a)}),this.stack=[],c.call(a))}};return g}();