/**
 * panels.js - version 1.7.1
 *
 * https://github.com/bcorreia/panels.js.git
 * Bruno Correia - mail@bcorreia.com
 *
 */
var Panels=function(){"use strict";function a(b,d){e=f(e.defaults,d||{});var g=new Event("init");if(document.addEventListener("init",function(){e.onInit()}),e.handlebars)var h=Handlebars.compile(document.querySelector('[data-role="stage"]').innerHTML),i=h(e.context);e.stage.fade?(i&&b.insertAdjacentHTML("afterbegin",i),b.style.opacity=0,imagesLoaded(b,function(){document.dispatchEvent(g),Velocity(b,{opacity:1},e.stage.speed,function(){b.removeAttribute("style")})})):(b.insertAdjacentHTML("afterbegin",i),document.dispatchEvent(g)),c.items=b.querySelectorAll(".item"),c.wrapper=b;for(var j=0;j<c.items.length;j++)c.items[j].setAttribute("data-position",j),c.items[j].addEventListener("click",function(b){b.preventDefault(),this.classList.contains("on")||a.prototype.open(this)},!1)}window.Velocity=window.Velocity||$.fn.velocity,window.imagesLoaded=window.imagesLoaded||function(a,b){return b()};var b=[],c={},d={},e={defaults:{handlebars:!0,context:{},url:void 0,stage:{fade:!0,speed:800},panel:{classes:"",position:"top",stackable:!0,speed:600,easing:"easeOutQuad"},scroll:{offset:0,speed:600,easing:"easeOutQuad"},onInit:function(){},onBefore:function(){},onAfter:function(){}}},f=function(a){var b={},c=function(a){for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&("[object Object]"===Object.prototype.toString.call(a[c])?b[c]=f(b[c],a[c]):b[c]=a[c])};c(arguments[0]);for(var d=1;d<arguments.length;d++){var e=arguments[d];c(e)}return b},g=function(a,b){void 0!==a&&Velocity(document.body,"scroll",{duration:b.speed,easing:b.easing,offset:a.getBoundingClientRect().top+window.scrollY-b.offset})};return c.on=function(){return this.classList.add("on")},c.off=function(){return c.wrapper.querySelector('[data-position="'+this+'"]').classList.remove("on")},c.reset=function(){for(var a=c.wrapper.querySelectorAll(".item.on"),b=0;b<a.length;b++)a[b].classList.remove("on");return[]},d.prepare=function(a,b){var c,d=document.createElement("div"),f=a.getAttribute("data-position");if(d.className="panel "+e.panel.classes,d.setAttribute("data-paired",f),e.handlebars)return c=Handlebars.compile(document.querySelector('[data-role="panel"]').innerHTML),d.innerHTML=c(e.context.items[f]),this.insert.call(d,a,b);var g,h=new XMLHttpRequest,i=a.getAttribute("data-query"),j="n="+f;if(i){var k=JSON.parse(i),l=[];for(var m in k)l.push(m+"="+k[m]);g=l.join("&")}g=g&&g.length?g+"&"+j:j,h.open("get",e.url+"?"+g,!0),h.send(),h.onload=function(){return d.innerHTML=h.response,this.insert.call(d,a,b)}.bind(this)},d.insert=function(a,f){var g,h,i="opacity:0; height:0";switch(this.innerHTML='<div class="-inner">'+this.innerHTML+"</div>",e.panel.position){case"between rows":this.style.cssText=i,h=d.placement.call(a),g=h.parentNode.insertBefore(this,h.nextSibling);break;case"top":this.style.cssText=i,g=c.wrapper.insertBefore(this,c.wrapper.firstChild);break;default:g=document.body.insertBefore(this,e.panel.position)}return b.push(g),d.listeners(g),("top"===e.panel.position||"between rows"===e.panel.position)&&d.seek.call(g),imagesLoaded(g,function(){return f.call(g)}.bind(g)),g},d.placement=function(){var a=this.getBoundingClientRect().top,b=this.nextElementSibling;return b.classList.contains("item")&&b.getBoundingClientRect().top===a?d.placement.call(b):this},d.listeners=function(d){var e=d.querySelectorAll("[data-role]");if(null!==e)for(var f=0;f<e.length;f++)e[f].addEventListener("click",function(e){e.preventDefault();for(var e=new Event("click"),f=b[b.length-1].getAttribute("data-paired"),g=c.wrapper.querySelector('[data-position="'+f+'"]'),h=g.previousElementSibling,i=g.nextElementSibling;null!==i&&i.classList.contains("panel");)i=i.nextElementSibling;switch(this.getAttribute("data-role")){case"close":a.prototype.close(d);break;case"previous":h.dispatchEvent(e);break;case"next":i.dispatchEvent(e)}})},d.route=function(c){if(!b.length||e.panel.stackable&&"top"===e.panel.position)return c();if(b.length)var d=b[b.length-1];a.prototype.close(d,function(){return c()})},d.reset=function(){b.length&&(b.forEach(function(a){a.parentNode.removeChild(a)}),b=[],c.reset())},d.seek=function(){for(var a=this.getAttribute("data-paired"),b=c.wrapper.querySelector('[data-position="'+a+'"]').previousElementSibling,d=c.wrapper.querySelector('[data-position="'+a+'"]').nextElementSibling;null!==d&&!d.classList.contains("item");)d=d.nextElementSibling;if(null===d||d.classList.contains("on")){var e=this.querySelector('[data-role="next"]');e&&e.classList.add("disabled")}if(null===b||b.classList.contains("on")||!b.classList.contains("item")){var e=this.querySelector('[data-role="previous"]');e&&e.classList.add("disabled")}},a.prototype={constructor:a,open:function(a,b){c.on.call(a),d.route(function(){var c=d.prepare(a,function(){var c={opacity:1};("top"===e.panel.position||"between rows"===e.panel.position)&&(c.height=this.querySelector(".-inner").offsetHeight),"top"===e.panel.position&&g(this,e.scroll),Velocity(this,c,e.panel.speed,e.panel.easing,function(){return this.style.height="auto","between rows"===e.panel.position&&g(a,e.scroll),e.onAfter("open",this),b&&b()}.bind(this))});e.onBefore("open",c)})},close:function(a,d){var f={opacity:0,height:0};void 0!==a&&(Velocity(a,f,e.panel.speed,e.panel.easing,function(){return c.off.call(a.getAttribute("data-paired")),a.parentNode&&a.parentNode.removeChild(a),b.pop(),e.onAfter("close",a),d&&d()}),e.onBefore("close",a))}},window.addEventListener("resize",function(){return"between rows"===e.panel.position&&!navigator.userAgent.match(/Mobi/)&&d.reset()},!0),a}();